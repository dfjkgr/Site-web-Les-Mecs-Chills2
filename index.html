<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Les Mecs Chills ‚Äî Hub Complet</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{ --bg:#0b0f14; --card:#0f1620; --muted:#9fb0c8; --accent1:#8e61ff; --accent2:#4fb3ff; --success:#43b581; --danger:#ff6b6b; --glass:rgba(255,255,255,0.03); --radius:12px; --trans:all .22s ease; --text:#eaf2ff; }
*{box-sizing:border-box}
body{margin:0;font-family:'Poppins',system-ui,Arial;background:linear-gradient(120deg,#071126,#08121a);color:var(--text);-webkit-font-smoothing:antialiased;padding-top:72px}
.nav{position:fixed;top:0;left:0;right:0;height:72px;display:flex;align-items:center;justify-content:space-between;padding:10px 22px;background:rgba(6,8,12,0.75);backdrop-filter: blur(6px);z-index:1000}
.logo{display:flex;gap:12px;align-items:center}
.logo .badge{width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800}
.menu{display:flex;gap:10px;align-items:center}
.menu a{padding:8px 12px;border-radius:8px;color:var(--muted);text-decoration:none;font-weight:600}
.menu a:hover{color:#fff;box-shadow:0 6px 24px rgba(79,179,255,0.06)}
.container{max-width:1150px;margin:24px auto;padding:0 20px}
.hero{display:flex;gap:20px;align-items:center;background:linear-gradient(180deg, rgba(143,86,255,0.06), rgba(79,179,255,0.02));padding:28px;border-radius:14px;box-shadow:0 8px 30px rgba(0,0,0,0.6)}
.hero-left{flex:1}
h1{font-size:34px;margin:0 0 8px}
.lead{color:var(--muted);margin:0 0 16px}
.btn{display:inline-block;padding:10px 16px;border-radius:999px;background:linear-gradient(90deg,var(--accent2),var(--accent1));color:#071126;font-weight:700;text-decoration:none;box-shadow:0 10px 30px rgba(123,97,255,0.12)}
.card{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.5)}
.section{margin-top:18px}
.cols{display:grid;grid-template-columns:1fr 360px;gap:18px;align-items:start}
@media(max-width:980px){.cols{grid-template-columns:1fr}}
.field{margin-bottom:10px}
label{display:block;color:var(--muted);font-size:13px;margin-bottom:6px}
input[type="text"],input[type="number"],input[type="password"],select,textarea{width:100%;padding:10px;border-radius:8px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.03);color:var(--text);outline:none}
textarea{min-height:90px;resize:vertical}
.small{font-size:13px;color:var(--muted)}
.list{display:flex;flex-direction:column;gap:10px}
.item{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:12px;border-radius:10px;display:flex;justify-content:space-between;gap:12px}
.tab{padding:8px 10px;border-radius:8px;background:transparent;color:var(--muted);cursor:pointer}
.tab.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#071126;font-weight:700}
.choice{display:block;padding:8px;border-radius:8px;margin:6px 0;border:1px solid rgba(255,255,255,0.03);cursor:pointer}
.hidden{display:none!important}
.footer{padding:20px;text-align:center;color:var(--muted);font-size:13px}
.badge{display:inline-block;padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.03);font-weight:700}
.small-muted{color:var(--muted)}
.admin-area{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:12px;border-radius:10px}
.btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:8px;color:var(--muted)}
</style>
</head>
<body>
<header class="nav">
  <div class="logo">
    <div class="badge">LMC</div>
    <div>
      <div style="font-weight:800">Les Mecs Chills</div>
      <div class="small">Serveur Discord ‚Ä¢ Hub communautaire</div>
    </div>
  </div>
  <nav class="menu" aria-label="Main">
    <a href="#home">Accueil</a>
    <a href="#about">√Ä propos</a>
    <a href="#brawl">Brawl Stars</a>
    <a href="#roles-section">R√¥les</a>
    <a href="#events">√âv√©nements</a>
    <a href="#community">Communaut√©</a>
    <a href="#games">Jeux</a>
    <a href="#contact">Contact</a>
    <a href="#help-section">Aide</a>
    <a href="#admin-section" id="navAdmin">Admin</a>
  </nav>
</header>
<main class="container">
  <section id="home" class="hero">
    <div class="hero-left">
      <h1>JUSTE DES MECS CHILLS EN FAIT !</h1>
      <p class="lead">Rejoins notre serveur Discord pour des tournois, quiz, mini-jeux et une ambiance chill. Clique pour rejoindre ou explore le site pour postuler et demander des r√¥les.</p>
      <div style="display:flex;gap:8px;align-items:center">
        <a class="btn" href="https://discord.gg/wUtq5ZA9Kt" target="_blank" rel="noopener">Rejoindre le serveur</a>
        <button id="btnOpenGames" class="btn" style="background:transparent;border:1px solid rgba(255,255,255,0.06)">Ouvrir jeux</button>
      </div>
    </div>
    <div style="width:340px;display:flex;flex-direction:column;gap:12px">
      <div class="card">
        <div style="font-weight:700">Prochains √©v√©nements</div>
        <div class="small" style="margin-top:6px">Tournoi Brawl ‚Äî Dimanche 20h</div>
      </div>
      <div class="card">
        <div style="font-weight:700">R√¥les VIP</div>
        <div class="small" style="margin-top:6px">Acc√®s salon VIP & avantages</div>
      </div>
    </div>
  </section>

  <section id="about" class="section">
    <div class="card">
      <h2>√Ä propos</h2>
      <p class="small">Notre serveur Discord est un espace o√π r√®gnent la bonne humeur, le respect et l'amiti√©. Chaque membre compte et a son r√¥le √† jouer dans la communaut√©.</p>
    </div>
  </section>

  <section id="brawl" class="section">
    <div class="card">
      <h2>Brawl Stars</h2>
      <p class="small">Une cat√©gorie d√©di√©e avec salons strat√©giques, clips, tournois et plus encore.</p>
    </div>
  </section>

  <section id="roles-section" class="section">
    <div class="card cols">
      <div>
        <h2>R√¥les & Demandes</h2>
        <p class="small">R√¥les dynamiques et demandes rapides.</p>
        <div style="margin-top:12px" id="quickRoleCard">
          <strong>Demande rapide</strong>
          <div class="field"><label>Pseudo</label><input id="rq_pseudo" type="text" placeholder="Ex: ChillUser#1234"></div>
          <div class="field"><label>R√¥le</label>
            <select id="rq_role"><option value="">-- Choisir --</option><option value="Mod√©rateur">Mod√©rateur</option><option value="Journaliste">Journaliste</option></select></div>
          <div style="margin-top:10px"><button class="btn" id="rq_submit">Demander (rapide)</button></div>
          <div id="rq_msg" class="small-muted" style="margin-top:8px"></div>
        </div>

        <div style="margin-top:18px" id="fullAppCard">
          <strong>Candidature compl√®te</strong>
          <form id="fullAppForm">
            <div class="field"><label>Pseudo Discord</label><input id="fa_pseudo" type="text" placeholder="Ex: ChillUser#1234" required></div>
            <div class="field"><label>√Çge</label><input id="fa_age" type="number" min="13" placeholder="√Çge"></div>
            <div class="field"><label>Exp√©rience</label><input id="fa_experience" type="text" placeholder="Exp√©rience sur Discord"></div>
            <div class="field"><label>Disponibilit√© (h / semaine)</label><input id="fa_hours" type="number" min="0" placeholder="Ex: 10"></div>
            <div class="field"><label>Lettre de motivation</label><textarea id="fa_motivation" maxlength="2000" placeholder="Pourquoi tu veux rejoindre le staff ?"></textarea></div>
            <div style="display:flex;gap:10px;align-items:center"><button id="fullAppSubmit" class="btn">Envoyer la candidature</button><div id="fullAppMsg" class="small-muted"></div></div>
          </form>
        </div>
      </div>

      <aside>
        <div class="card">
          <strong>R√¥les en rotation</strong>
          <div id="rolesList" style="margin-top:8px" class="small-muted">Aucun r√¥le</div>
          <button id="createDemoRole" class="btn-ghost" style="margin-top:8px">Cr√©er r√¥le d√©mo</button>
        </div>
      </aside>
    </div>
  </section>

  <section id="events" class="section">
    <div class="card">
      <h2>√âv√©nements</h2>
      <p class="small">Tournois hebdo, soir√©es chill, concours cr√©a.</p>
    </div>
  </section>

  <section id="community" class="section">
    <div class="card">
      <h2>Communaut√©</h2>
      <p class="small">Partage, entraide et fun !</p>
    </div>
  </section>

  <section id="games" class="section">
    <div class="card cols">
      <div>
        <h2>Jeux & Quiz</h2>
        <div class="card" style="margin-top:8px;padding:12px">
          <strong>Saisis ton pseudo pour jouer</strong>
          <div style="margin-top:8px"><input id="playerPseudo" placeholder="Ex: ChillPlayer#1234"></div>
        </div>

        <div class="card" style="margin-top:12px;padding:12px" id="quizCard">
          <h3>Quiz Culture G√©n√©rale</h3>
          <div id="quizContainer">Chargement quiz...</div>
        </div>

        <div class="card" style="margin-top:12px;padding:12px">
          <h3>Devine le chiffre (1-20)</h3>
          <div style="display:flex;gap:8px"><input id="guess_input" type="number" min="1" max="20" placeholder="1-20"><button id="guess_btn" class="btn">Valider</button></div>
          <div id="guess_feedback" class="small-muted" style="margin-top:8px"></div>
        </div>

        <div class="card" style="margin-top:12px;padding:12px">
          <h3>Pierre / Feuille / Ciseaux</h3>
          <div style="display:flex;gap:8px"><button class="btn" data-rps="rock">Pierre</button><button class="btn" data-rps="paper">Feuille</button><button class="btn" data-rps="scissors">Ciseaux</button></div>
          <div id="rps_feedback" class="small-muted" style="margin-top:8px"></div>
        </div>

        <div class="card" style="margin-top:12px;padding:12px">
          <h3>Dice Roll</h3>
          <div style="display:flex;gap:8px"><button id="rollDiceBtn" class="btn">Lancer le d√©</button><div id="diceRes" class="small-muted"></div></div>
        </div>

        <div class="card" style="margin-top:12px;padding:12px">
          <h3>Memory Mini</h3>
          <div id="memoryArea"></div>
        </div>

        <div class="card" style="margin-top:12px;padding:12px">
          <h3>Flag Quiz</h3>
          <div id="flagArea"></div>
        </div>

        <div class="card" style="margin-top:12px;padding:12px">
          <h3>Scramble Word</h3>
          <div style="display:flex;gap:8px"><div id="scrambleWord" class="small-muted"></div><input id="scrambleGuess" placeholder="ton essai"><button id="scrambleBtn" class="btn">Valider</button></div>
          <div id="scrambleRes" class="small-muted" style="margin-top:8px"></div>
        </div>

      </div>

      <aside>
        <div class="card">
          <strong>Leaderboard</strong>
          <div id="leaderboard" style="margin-top:10px" class="small-muted">Aucun score</div>
        </div>

        <div class="card" style="margin-top:12px">
          <strong>Badges</strong>
          <div id="badges" style="margin-top:8px" class="small-muted">Aucun badge</div>
        </div>

        <div class="card" style="margin-top:12px">
          <strong>Charger 3D</strong>
          <div style="margin-top:8px"><button id="load3d" class="btn">Charger d√©mo 3D</button></div>
          <div id="threeDContainer" style="margin-top:8px"></div>
        </div>
      </aside>
    </div>
  </section>

  <section id="contact" class="section">
    <div class="card cols">
      <div>
        <h2>Contact / Suggestions</h2>
        <p class="small">Laisse une suggestion ‚Äî elle sera visible par l'admin.</p>
        <div style="margin-top:10px"><input id="suggest_pseudo" placeholder="Pseudo (optionnel)"><textarea id="suggest_text" placeholder="Ta suggestion" style="margin-top:8px"></textarea><div style="margin-top:8px"><button id="suggest_send" class="btn">Envoyer suggestion</button></div><div id="suggest_msg" class="small-muted" style="margin-top:8px"></div></div>
      </div>
      <aside>
        <div class="card">
          <strong>Suggestions r√©centes</strong>
          <div id="recentSuggestions" class="small-muted" style="margin-top:10px">Aucune</div>
        </div>
      </aside>
    </div>
  </section>

  <section id="help-section" class="section">
    <div class="card cols">
      <div>
        <h2>Aide du site</h2>
        <p class="small">Si tu as besoin d'aide, signale-le ici ‚Äî l'admin r√©pondra publiquement dans la section Informations Aide.</p>
        <div style="margin-top:10px"><input id="helpPseudo" placeholder="Pseudo (optionnel)"><textarea id="helpQuestion" placeholder="Ta question / probl√®me" style="margin-top:8px"></textarea><div style="margin-top:8px"><button id="helpSend" class="btn">Envoyer demande d'aide</button></div><div id="helpMsg" class="small-muted" style="margin-top:8px"></div></div>
      </div>
      <aside>
        <div class="card">
          <strong>Informations / Aide</strong>
          <div id="helpAnswers" style="margin-top:10px" class="small-muted">Aucune</div>
        </div>
      </aside>
    </div>
  </section>

  <section id="admin-section" class="section">
    <div class="card">
      <h2>Panneau Admin</h2>
      <div id="adminAuth">
        <div style="display:flex;gap:8px;align-items:center"><input id="adminPassInput" type="password" placeholder="Mot de passe admin"><button id="adminLoginBtn" class="btn">Se connecter</button><div id="adminAuthMsg" class="small-muted"></div></div>
      </div>

      <div id="adminDashboard" class="hidden" style="margin-top:12px">
        <div style="display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap">
          <div class="tabs" role="tablist">
            <div class="tab active" data-tab="suggestionsTab">Suggestions</div>
            <div class="tab" data-tab="quickappsTab">Quick-Apps</div>
            <div class="tab" data-tab="applicationsTab">Applications</div>
            <div class="tab" data-tab="rolesTab">Roles</div>
            <div class="tab" data-tab="helpTab">Aide</div>
            <div class="tab" data-tab="auditTab">Audit</div>
            <div class="tab" data-tab="meetingTab">R√©union</div>
          </div>
          <div style="display:flex;gap:8px"><button id="adminExport" class="btn">Exporter JSON</button><button id="adminClearAll" class="btn" style="background:var(--danger)">Tout effacer</button></div>
        </div>

        <div id="adminTabContent" style="margin-top:12px">
          <div id="suggestionsTab" class="list"></div>
          <div id="quickappsTab" class="list hidden"></div>
          <div id="applicationsTab" class="list hidden"></div>
          <div id="rolesTab" class="list hidden"></div>
          <div id="helpTab" class="list hidden"></div>
          <div id="auditTab" class="list hidden"></div>
          <div id="meetingTab" class="list hidden"></div>
        </div>

        <div style="margin-top:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap">
          <input id="awardPseudo" placeholder="Pseudo"><input id="awardPoints" type="number" placeholder="Points"><button id="awardBtn" class="btn">Attribuer points</button>
          <input id="awardBadgeName" placeholder="Nom du badge"><button id="awardBadgeBtn" class="btn">Attribuer badge</button>
        </div>

      </div>
    </div>
  </section>

  <footer class="footer">¬© Les Mecs Chills ‚Äî Demo ‚Ä¢ Donn√©es en local (localStorage)</footer>
</main>

<script>
// ----------------- Helpers localStorage & audit -----------------
function lmc_get(key, def){ try{ const r = localStorage.getItem(key); return r ? JSON.parse(r) : def; }catch(e){console.error(e); return def;} }
function lmc_set(key, value){ try{ localStorage.setItem(key, JSON.stringify(value)); return true; }catch(e){console.error(e); return false;} }
function auditLog(type,message){ const a = lmc_get('lmc_audit',[]); a.unshift({time:new Date().toISOString(),type,message}); lmc_set('lmc_audit', a.slice(0,200)); }

// Ensure keys
(function init(){ lmc_get('lmc_suggestions',[]); lmc_get('lmc_quick_apps',[]); lmc_get('lmc_applications',[]); lmc_get('lmc_roles',[]); lmc_get('lmc_quiz_scores',[]); lmc_get('lmc_gameResults',[]); lmc_get('lmc_helpRequests',[]); lmc_get('lmc_meetingBoard',[]); lmc_get('lmc_ai_saved',[]); lmc_get('lmc_announcements',[]); })();

// ----------------- Member stats & badges stored in lmc_ai_saved -----------------
function getMemberStats(){ const saved = lmc_get('lmc_ai_saved',[]); let s = saved.find(x=>x && x.type==='member_stats'); if(!s){ s = {type:'member_stats',map:{}}; saved.unshift(s); lmc_set('lmc_ai_saved', saved); } return s.map; }
function saveMemberStats(map){ const saved = lmc_get('lmc_ai_saved',[]); const idx = saved.findIndex(x=>x && x.type==='member_stats'); const obj = {type:'member_stats',map}; if(idx>=0) saved[idx]=obj; else saved.unshift(obj); lmc_set('lmc_ai_saved', saved); }
function addPoints(pseudo, pts){ if(!pseudo) pseudo='anonymous'; const map = getMemberStats(); if(!map[pseudo]) map[pseudo]={points:0,badges:[]}; map[pseudo].points = (map[pseudo].points||0)+pts; // auto badges
 if(map[pseudo].points>=100 && !map[pseudo].badges.includes('Legend Chill')) map[pseudo].badges.push('Legend Chill');
 if(map[pseudo].points>=50 && !map[pseudo].badges.includes('Pro Chill')) map[pseudo].badges.push('Pro Chill');
 if(map[pseudo].points>=10 && !map[pseudo].badges.includes('Rookie Chill')) map[pseudo].badges.push('Rookie Chill');
 saveMemberStats(map); auditLog('points', `+${pts} pts -> ${pseudo}`); renderLeaderboard(); renderBadges(); }
function awardBadge(pseudo,badge){ if(!pseudo) pseudo='anonymous'; const map=getMemberStats(); if(!map[pseudo]) map[pseudo]={points:0,badges:[]}; if(!map[pseudo].badges.includes(badge)) map[pseudo].badges.push(badge); saveMemberStats(map); auditLog('badge', `${badge} -> ${pseudo}`); renderBadges(); }

// ----------------- Render leaderboard & badges -----------------
function renderLeaderboard(){ const map = getMemberStats(); const arr = Object.keys(map).map(k=>({pseudo:k,points:map[k].points||0})).sort((a,b)=>b.points-a.points); const el = document.getElementById('leaderboard'); el.innerHTML = arr.length ? arr.slice(0,10).map((x,i)=>`${i+1}. <b>${escapeHTML(x.pseudo)}</b> ‚Äî ${x.points} pts`).join('<br>') : 'Aucun score'; }
function renderBadges(){ const map=getMemberStats(); const badges = Object.keys(map).flatMap(k => (map[k].badges||[]).map(b=>({pseudo:k,badge:b}))); const el=document.getElementById('badges'); el.innerHTML = badges.length ? badges.slice(0,12).map(x=>`${escapeHTML(x.pseudo)} ‚Ä¢ ${escapeHTML(x.badge)}`).join('<br>') : 'Aucun badge'; }

// ----------------- Utility -----------------
function escapeHTML(s){ if(!s && s!==0) return ''; return String(s).replace(/[&<>\"']/g, ch=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[ch])); }

// ----------------- Suggestions -----------------
function renderRecentSuggestions(){ const list = lmc_get('lmc_suggestions',[]); document.getElementById('recentSuggestions').innerHTML = list.length ? list.slice(0,6).map(s=>escapeHTML(s.pseudo? `${s.pseudo}: ${s.text}`: s)).join('<br>') : 'Aucune'; }
document.getElementById('suggest_send').addEventListener('click', ()=>{ const pseudo=document.getElementById('suggest_pseudo').value.trim(); const text=document.getElementById('suggest_text').value.trim(); if(!text){ document.getElementById('suggest_msg').textContent='Suggestion vide'; return; } const arr=lmc_get('lmc_suggestions',[]); arr.unshift({pseudo: pseudo||'Anon', text, date:new Date().toISOString()}); lmc_set('lmc_suggestions', arr); auditLog('suggestion', `${pseudo||'Anon'}: ${text.slice(0,80)}`); addPoints(pseudo||'Anon',3); document.getElementById('suggest_msg').textContent='Suggestion envoy√©e'; document.getElementById('suggest_pseudo').value=''; document.getElementById('suggest_text').value=''; renderRecentSuggestions(); renderAdminSuggestions(); });

function renderAdminSuggestions(){ const arr=lmc_get('lmc_suggestions',[]); const el=document.getElementById('suggestionsTab'); if(!arr.length){ el.innerHTML='<div class="item">Aucune suggestion</div>'; return; } el.innerHTML = arr.map((s,i)=>`<div class="item"><div><b>${escapeHTML(s.pseudo)}</b><div class="meta">${escapeHTML(s.text)}</div><div class="meta">${new Date(s.date).toLocaleString()}</div></div><div style="display:flex;flex-direction:column;gap:6px"><button onclick="adminDeleteSuggestion(${i})">Suppr</button></div></div>`).join(''); }
function adminDeleteSuggestion(i){ const arr=lmc_get('lmc_suggestions',[]); arr.splice(i,1); lmc_set('lmc_suggestions',arr); auditLog('admin','Suggestion supprim√©e'); renderAdminSuggestions(); renderRecentSuggestions(); }

// ----------------- Quick Apps & Applications -----------------
function renderQuickApps(){ const arr=lmc_get('lmc_quick_apps',[]); const el=document.getElementById('quickappsTab'); if(!arr.length){ el.innerHTML='<div class="item">Aucune postulation rapide</div>'; return; } el.innerHTML = arr.map((q,i)=>`<div class="item"><div><b>${escapeHTML(q.pseudo)}</b><div class="meta">${escapeHTML(q.role||q.message||'--')}</div><div class="meta">${new Date(q.date).toLocaleString()}</div></div><div style="display:flex;flex-direction:column;gap:6px"><button onclick="adminHandleQuick(${i})">Traiter</button><button onclick="adminDelQuick(${i})" style="background:var(--danger);color:#fff">Suppr</button></div></div>`).join(''); }
function renderApplications(){ const arr=lmc_get('lmc_applications',[]); const el=document.getElementById('applicationsTab'); if(!arr.length){ el.innerHTML='<div class="item">Aucune candidature</div>'; return; } el.innerHTML = arr.map((a,i)=>`<div class="item" style="flex-direction:column;align-items:flex-start"><div><b>${escapeHTML(a.pseudo||a.discord||'Anon')}</b> ‚Ä¢ ${escapeHTML(a.age||'n/a')} ans ‚Ä¢ dispo: ${escapeHTML(a.hours||'n/a')}h</div><div class="meta" style="margin-top:8px">Exp: ${escapeHTML(a.experience||'--')}</div><div class="meta" style="margin-top:8px">Motivation: ${escapeHTML(a.motivation||'--')}</div><div class="meta" style="margin-top:8px">${new Date(a.date).toLocaleString()}</div><div style="margin-top:10px;display:flex;gap:8px"><button onclick="adminAcceptApplication(${i})">Accepter</button><button onclick="adminDeleteApplication(${i})" style="background:var(--danger);color:#fff">Suppr</button></div></div>`).join(''); }
function adminHandleQuick(i){ const arr=lmc_get('lmc_quick_apps',[]); if(!arr[i]) return; arr[i].handled=true; lmc_set('lmc_quick_apps',arr); auditLog('admin',`Quick-app trait√©e: ${arr[i].pseudo}`); renderQuickApps(); }
function adminDelQuick(i){ const arr=lmc_get('lmc_quick_apps',[]); arr.splice(i,1); lmc_set('lmc_quick_apps',arr); auditLog('admin','quick deleted'); renderQuickApps(); }
function adminAcceptApplication(i){ const arr=lmc_get('lmc_applications',[]); if(!arr[i]) return; const app=arr[i]; const roleId = createRole(`Member-${app.pseudo||'user'}`, 'Accepted applicant'); auditLog('admin', `Application accept√©e: ${app.pseudo||app.discord} -> role ${roleId}`); arr.splice(i,1); lmc_set('lmc_applications',arr); renderApplications(); renderRoles(); }
function adminDeleteApplication(i){ const arr=lmc_get('lmc_applications',[]); arr.splice(i,1); lmc_set('lmc_applications',arr); auditLog('admin','application deleted'); renderApplications(); }

// ----------------- Roles management -----------------
function createRole(name,desc){ const roles=lmc_get('lmc_roles',[]); const id='r'+Date.now(); roles.unshift({id,name,desc}); lmc_set('lmc_roles',roles); auditLog('role',`Role created: ${name}`); renderRoles(); return id; }
function deleteRole(id){ let roles=lmc_get('lmc_roles',[]); roles=roles.filter(r=>r.id!==id); lmc_set('lmc_roles',roles); auditLog('role',`Role deleted: ${id}`); renderRoles(); }
function renderRoles(){ const roles=lmc_get('lmc_roles',[]); const el=document.getElementById('rolesTab'); const publicRoles=document.getElementById('rolesList'); el.innerHTML = roles.length ? roles.map(r=>`<div class="item"><div><b>${escapeHTML(r.name)}</b><div class="meta">${escapeHTML(r.desc||'')}</div></div><div><button onclick="deleteRole('${r.id}')">Suppr</button></div></div>`).join('') : '<div class="item">Aucun r√¥le</div>'; publicRoles.innerHTML = roles.length ? roles.map(r=>`<div class="small">${escapeHTML(r.name)}${r.desc? ' ‚Ä¢ '+escapeHTML(r.desc):''}</div>`).join('') : '<div class="small-muted">Aucun r√¥le</div>'; }

// ----------------- Help Requests & Answers -----------------
function renderHelpRequests(){ const requests=lmc_get('lmc_helpRequests',[]); const el=document.getElementById('helpTab'); if(!requests.length){ el.innerHTML='<div class="item">Aucune demande</div>'; return; } el.innerHTML = requests.map((req,i)=>`<div class="item"><div><b>${escapeHTML(req.pseudo||'Anon')}</b><div class="meta">${escapeHTML(req.question)}</div><div class="meta">${req.answer? 'R√©ponse: '+escapeHTML(req.answer):'‚ùå Pas de r√©ponse'}</div></div><div style="display:flex;flex-direction:column;gap:6px"><input id="helpAnswer${i}" placeholder="R√©pondre..."><button onclick="replyHelp(${i})">R√©pondre</button></div></div>`).join(''); }
function replyHelp(i){ const requests=lmc_get('lmc_helpRequests',[]); const answer = document.getElementById('helpAnswer'+i).value.trim(); if(!answer) return alert('√âcris une r√©ponse'); requests[i].answer = answer; lmc_set('lmc_helpRequests',requests); auditLog('admin',`Help replied: ${requests[i].pseudo}`); renderHelpRequests(); renderHelpAnswers(); }
function renderHelpAnswers(){ const requests=lmc_get('lmc_helpRequests',[]); const out = requests.filter(r=>r.answer).map(r=>`<div class="suggestion"><b>${escapeHTML(r.pseudo||'Anon')}</b> a demand√©: ${escapeHTML(r.question)}<br>üí° R√©ponse: ${escapeHTML(r.answer)}</div>`).join(''); document.getElementById('helpAnswers').innerHTML = out || 'Aucune'; }

// ----------------- Meeting board (admin) -----------------
function postMeetingMsg(){ const txt = prompt('√âcris ton message pour le board de r√©union (short):'); if(!txt) return; const board=lmc_get('lmc_meetingBoard',[]); board.unshift({text:txt, time:new Date().toISOString()}); lmc_set('lmc_meetingBoard',board); auditLog('meeting','New meeting msg'); renderMeetingBoard(); }
function renderMeetingBoard(){ const board=lmc_get('lmc_meetingBoard',[]); const el=document.getElementById('meetingTab'); el.innerHTML = board.length ? board.map(m=>`<div class="item">${escapeHTML(m.text)}<div class="meta">${new Date(m.time).toLocaleString()}</div></div>`).join('') : '<div class="item">Aucun message de r√©union</div>'; }

// ----------------- Audit -----------------
function renderAudit(){ const logs=lmc_get('lmc_audit',[]); const el=document.getElementById('auditTab'); if(!logs.length){ el.innerHTML = '<div class="item">Journal vide</div>'; return; } el.innerHTML = logs.slice(0,200).map(l=>`<div class="item"><div><b>${escapeHTML(l.type)}</b><div class="meta">${escapeHTML(l.message)}</div></div><div class="meta">${new Date(l.time).toLocaleString()}</div></div>`).join(''); }

// ----------------- Games & Quiz implementations -----------------
let currentQuiz = null;
const cultureQuiz = { quizId:'culture_01', title:'Quiz Culture G√©n√©rale', description:'10 questions', questions:[ { q:'Quelle est la capitale de l\'Espagne ?', choices:['Madrid','Barcelone','Valence','S√©ville'], answer:0 }, { q:'Qui a peint la Joconde ?', choices:['Van Gogh','Picasso','L√©onard de Vinci','Rembrandt'], answer:2 }, { q:'Combien de continents ?', choices:['5','6','7','8'], answer:2 }, { q:'Symbole O ?', choices:['Or','Oxyg√®ne','Argent','Osmium'], answer:1 }, { q:'Langue la plus parl√©e ?', choices:['Anglais','Mandarin','Espagnol','Arabe'], answer:1 }, { q:'Plus grand oc√©an ?', choices:['Atlantique','Indien','Pacifique','Arctique'], answer:2 }, { q:'Auteur Le Petit Prince ?', choices:['Saint-Exup√©ry','Victor Hugo','Jules Verne','Camus'], answer:0 }, { q:'Plan√®te rouge ?', choices:['V√©nus','Mars','Jupiter','Saturne'], answer:1 }, { q:'Ann√©e premier pas sur la Lune ?', choices:['1965','1969','1972','1959'], answer:1 }, { q:'Pays du Soleil Levant ?', choices:['Chine','Japon','Tha√Ølande','Cor√©e'], answer:1 } ] };
function renderCultureQuiz(){ currentQuiz = cultureQuiz; const c = document.getElementById('quizContainer'); let html = `<div><strong>${escapeHTML(cultureQuiz.title)}</strong><div class="small">${escapeHTML(cultureQuiz.description)}</div>`; cultureQuiz.questions.forEach((qq,idx)=>{ html += `<div class="question"><div><b>Q${idx+1}</b> ${escapeHTML(qq.q)}</div>`; qq.choices.forEach((ch,i)=>{ html += `<label class="choice"><input type="radio" name="cq_${idx}" value="${i}"> ${escapeHTML(ch)}</label>`; }); html += `</div>`; }); html += `<div style="margin-top:8px"><button id="submitCulture" class="btn">Soumettre</button><div id="cultureRes" class="small-muted" style="margin-top:8px"></div></div></div>`; c.innerHTML = html; document.getElementById('submitCulture').addEventListener('click', ()=>{ const pseudo = document.getElementById('playerPseudo').value.trim() || 'anonymous'; let score=0; for(let i=0;i<cultureQuiz.questions.length;i++){ const sel=document.querySelector(`input[name="cq_${i}"]:checked`); if(sel && parseInt(sel.value,10)===cultureQuiz.questions[i].answer) score++; } const scoreObj={quizId:cultureQuiz.quizId, pseudo, score, total:cultureQuiz.questions.length, date:new Date().toISOString()}; const arr=lmc_get('lmc_quiz_scores',[]); arr.unshift(scoreObj); lmc_set('lmc_quiz_scores',arr); auditLog('quiz',`Score ${score}/${cultureQuiz.questions.length} by ${pseudo}`); addPoints(pseudo, score*3); document.getElementById('cultureRes').textContent=`Score: ${score}/${cultureQuiz.questions.length} ‚Äî sauvegard√©`; renderLeaderboard(); }); }

// Guess number game
function setupGuess(){ const btn=document.getElementById('guess_btn'); btn.addEventListener('click', ()=>{ const pseudo=document.getElementById('playerPseudo').value.trim()||'anonymous'; const val=parseInt(document.getElementById('guess_input').value,10); const out=document.getElementById('guess_feedback'); if(!val||val<1||val>20){ out.textContent='Choisis 1-20'; return; } const rnd=Math.floor(Math.random()*20)+1; if(val===rnd){ out.textContent=`Bravo ! C'√©tait ${rnd} üéâ`; addPoints(pseudo,5); auditLog('game',`Guess correct by ${pseudo}`); } else { out.textContent=`Perdu ‚Äî le nombre √©tait ${rnd}`; auditLog('game',`Guess ${val} by ${pseudo} vs ${rnd}`); } renderLeaderboard(); }); }

// RPS
function setupRPS(){ document.querySelectorAll('[data-rps]').forEach(btn=>{ btn.addEventListener('click', ()=>{ const pseudo=document.getElementById('playerPseudo').value.trim()||'anonymous'; const choice=btn.dataset.rps; const ops=['rock','paper','scissors']; const comp=ops[Math.floor(Math.random()*3)]; const out=document.getElementById('rps_feedback'); const decide=(a,b)=>{ if(a===b) return '√âgalit√©'; if((a==='rock'&&b==='scissors')||(a==='paper'&&b==='rock')||(a==='scissors'&&b==='paper')) return 'Tu gagnes!'; return 'Tu perds'; }; const res=decide(choice,comp); out.textContent=`Toi: ${choice} ‚Äî Ordi: ${comp} ‚Üí ${res}`; auditLog('game',`RPS ${choice} vs ${comp} by ${pseudo}`); if(res==='Tu gagnes!') addPoints(pseudo,2); else if(res==='√âgalit√©') addPoints(pseudo,1); renderLeaderboard(); }); }); }

// Dice roll
function setupDice(){ document.getElementById('rollDiceBtn').addEventListener('click', ()=>{ const pseudo=document.getElementById('playerPseudo').value.trim()||'anonymous'; const p=Math.floor(Math.random()*6)+1; const c=Math.floor(Math.random()*6)+1; const out=document.getElementById('diceRes'); out.textContent=`Toi: ${p} ‚Äî Ordi: ${c}`; if(p>c){ out.textContent+= ' ‚Üí Gagn√©'; addPoints(pseudo,3);} else if(p===c){ out.textContent+= ' ‚Üí √âgalit√©'; addPoints(pseudo,1);} else out.textContent+= ' ‚Üí Perdu'; auditLog('game',`Dice ${p} vs ${c} by ${pseudo}`); renderLeaderboard(); }); }

// Memory
function setupMemory(){ const area=document.getElementById('memoryArea'); const icons=['üçÄ','üî•','‚ö°','üåä','üåü','üçï']; const deck=shuffle(icons.concat(icons)).slice(0,8); area.innerHTML = '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:6px"></div>'; const grid=area.querySelector('div'); deck.forEach((v,i)=>{ const card=document.createElement('button'); card.className='btn-ghost'; card.style.height='56px'; card.style.fontSize='20px'; card.dataset.val=v; card.dataset.open='0'; card.textContent='?'; grid.appendChild(card); card.addEventListener('click', ()=>{ if(card.dataset.open==='1' || card.dataset.matched==='1') return; card.textContent=card.dataset.val; card.dataset.open='1'; const opened=Array.from(grid.children).filter(c=>c.dataset.open==='1' && c.dataset.matched!=='1'); if(opened.length===2){ if(opened[0].dataset.val===opened[1].dataset.val){ opened.forEach(o=>{ o.dataset.matched='1'; }); auditLog('game','memory pair'); addPoints('anonymous',1); renderLeaderboard(); } else { setTimeout(()=>{ opened.forEach(o=>{ if(o.dataset.matched!=='1'){ o.dataset.open='0'; o.textContent='?'; } }); },700); } } }); }); }
function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }

// Flag quiz
const flags=[{country:'France',emoji:'üá´üá∑'},{country:'Japon',emoji:'üáØüáµ'},{country:'Br√©sil',emoji:'üáßüá∑'},{country:'Canada',emoji:'üá®üá¶'},{country:'Inde',emoji:'üáÆüá≥'},{country:'Italie',emoji:'üáÆüáπ'}];
function renderFlag(){ const pick=[...flags].sort(()=>0.5-Math.random()).slice(0,4); const correct=pick[Math.floor(Math.random()*4)]; const dom=document.getElementById('flagArea'); dom.innerHTML=`<div style="font-size:40px">${correct.emoji}</div><div style="margin-top:8px">${pick.map(p=>`<button class=\"btn-ghost\" style=\"margin-right:6px\" onclick=\"flagAns('${p.country}','${correct.country}')\">${p.country}</button>`).join('')}</div>`; }
window.flagAns=function(guess,correct){ const dom=document.getElementById('flagArea'); if(guess===correct){ dom.innerHTML='<div class="small-muted">Bonne r√©ponse !</div>'; addPoints('anonymous',2);} else dom.innerHTML=`<div class="small-muted">Non ‚Äî c\'√©tait ${escapeHTML(correct)}</div>`; auditLog('game',`flag ${guess}`); renderLeaderboard(); }

// Scramble
const words=['chill','discord','mecs','community','tournament','badge']; let currentWord=''; function scrambleNew(){ currentWord=words[Math.floor(Math.random()*words.length)]; document.getElementById('scrambleWord').textContent=currentWord.split('').sort(()=>0.5-Math.random()).join(''); }
document.getElementById('scrambleBtn').addEventListener('click', ()=>{ const g=document.getElementById('scrambleGuess').value.trim().toLowerCase(); if(!g){ document.getElementById('scrambleRes').textContent='Entre une r√©ponse'; return; } if(g===currentWord){ document.getElementById('scrambleRes').textContent='Correct !'; addPoints('anonymous',3); auditLog('game','scramble correct'); renderLeaderboard(); scrambleNew(); } else document.getElementById('scrambleRes').textContent='Non, r√©essaie'; }); scrambleNew();

// Three.js lazy-load
document.getElementById('load3d').addEventListener('click', ()=>{ const btn=document.getElementById('load3d'); btn.disabled=true; btn.textContent='Chargement...'; const s=document.createElement('script'); s.src='https://unpkg.com/three@0.152.2/build/three.min.js'; s.onload=()=>{ const area=document.getElementById('threeDContainer'); const scene=new THREE.Scene(); const camera=new THREE.PerspectiveCamera(50,400/200,0.1,1000); const renderer=new THREE.WebGLRenderer({antialias:true}); renderer.setSize(400,200); area.appendChild(renderer.domElement); const geometry=new THREE.BoxGeometry(1,1,1); const material=new THREE.MeshNormalMaterial(); const cube=new THREE.Mesh(geometry,material); scene.add(cube); camera.position.z=3; (function animate(){ requestAnimationFrame(animate); cube.rotation.x+=0.01; cube.rotation.y+=0.01; renderer.render(scene,camera); })(); btn.style.display='none'; auditLog('3d','loaded'); }; s.onerror=()=>{ btn.textContent='Erreur chargement'; }; document.head.appendChild(s); });

// ----------------- Admin wiring -----------------
const ADMIN_PASS='89mLh21'; document.getElementById('adminLoginBtn').addEventListener('click', ()=>{ const v=document.getElementById('adminPassInput').value; const msg=document.getElementById('adminAuthMsg'); if(v===ADMIN_PASS){ msg.textContent='Acc√®s autoris√©'; msg.style.color='lightgreen'; document.getElementById('adminDashboard').classList.remove('hidden'); renderAdminSuggestions(); renderQuickApps(); renderApplications(); renderRoles(); renderHelpRequests(); renderHelpAnswers(); renderMeetingBoard(); renderAudit(); } else { msg.textContent='Mot de passe incorrect'; msg.style.color='salmon'; auditLog('security','Failed admin login attempt'); }});

// Tabs
document.querySelectorAll('.tab').forEach(t=>t.addEventListener('click', ()=>{ document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active')); t.classList.add('active'); document.querySelectorAll('#adminTabContent > .list').forEach(x=>x.classList.add('hidden')); document.getElementById(t.dataset.tab).classList.remove('hidden'); if(t.dataset.tab==='suggestionsTab') renderAdminSuggestions(); if(t.dataset.tab==='quickappsTab') renderQuickApps(); if(t.dataset.tab==='applicationsTab') renderApplications(); if(t.dataset.tab==='rolesTab') renderRoles(); if(t.dataset.tab==='helpTab') renderHelpRequests(); if(t.dataset.tab==='auditTab') renderAudit(); if(t.dataset.tab==='meetingTab') renderMeetingBoard(); }));

document.getElementById('adminExport').addEventListener('click', ()=>{ const dump={ suggestions: lmc_get('lmc_suggestions',[]), quick_apps: lmc_get('lmc_quick_apps',[]), applications: lmc_get('lmc_applications',[]), roles: lmc_get('lmc_roles',[]), audit: lmc_get('lmc_audit',[]), quiz_scores: lmc_get('lmc_quiz_scores',[]), game_results: lmc_get('lmc_gameResults',[]), ai_saved: lmc_get('lmc_ai_saved',[]) }; const blob=new Blob([JSON.stringify(dump,null,2)],{type:'application/json'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='lmc_export.json'; document.body.appendChild(a); a.click(); a.remove(); });

document.getElementById('adminClearAll').addEventListener('click', ()=>{ if(!confirm('Effacer toutes les donn√©es locales ?')) return; lmc_set('lmc_suggestions',[]); lmc_set('lmc_quick_apps',[]); lmc_set('lmc_applications',[]); lmc_set('lmc_roles',[]); lmc_set('lmc_audit',[]); lmc_set('lmc_quiz_scores',[]); lmc_set('lmc_gameResults',[]); lmc_set('lmc_helpRequests',[]); lmc_set('lmc_meetingBoard',[]); lmc_set('lmc_ai_saved',[]); renderAll(); });

// Award points/badges by admin
document.getElementById('awardBtn').addEventListener('click', ()=>{ const p=document.getElementById('awardPseudo').value.trim(); const pts=parseInt(document.getElementById('awardPoints').value,10)||0; if(!p||!pts){ alert('Pseudo et points requis'); return; } addPoints(p,pts); alert(`+${pts} pts √† ${p}`); });
document.getElementById('awardBadgeBtn').addEventListener('click', ()=>{ const p=document.getElementById('awardPseudo').value.trim(); const b=document.getElementById('awardBadgeName').value.trim(); if(!p||!b) return alert('Pseudo et badge requis'); awardBadge(p,b); alert(`${b} attribu√© √† ${p}`); });

// ----------------- UI hookups for public forms -----------------
document.getElementById('rq_submit').addEventListener('click', ()=>{ const pseudo=document.getElementById('rq_pseudo').value.trim(); const role=document.getElementById('rq_role').value; const msg=document.getElementById('rq_msg'); if(!pseudo||!role){ msg.textContent='Pseudo et r√¥le requis'; return; } const arr=lmc_get('lmc_quick_apps',[]); arr.unshift({pseudo,role,date:new Date().toISOString(),handled:false}); lmc_set('lmc_quick_apps',arr); auditLog('quickapp',`Quick-app ${role} by ${pseudo}`); addPoints(pseudo,2); msg.textContent=`Demande rapide envoy√©e pour ${pseudo} ‚Üí ${role}`; document.getElementById('rq_pseudo').value=''; document.getElementById('rq_role').selectedIndex=0; renderQuickApps(); });

document.getElementById('fullAppSubmit').addEventListener('click', (e)=>{ e.preventDefault(); const pseudo=document.getElementById('fa_pseudo').value.trim(); const age=document.getElementById('fa_age').value; const exp=document.getElementById('fa_experience').value.trim(); const hours=document.getElementById('fa_hours').value; const mot=document.getElementById('fa_motivation').value.trim(); const msgEl=document.getElementById('fullAppMsg'); if(!pseudo||!age){ msgEl.textContent='Pseudo & √¢ge requis'; return; } const arr=lmc_get('lmc_applications',[]); arr.unshift({pseudo,age,experience:exp,hours,motivation:mot,date:new Date().toISOString()}); lmc_set('lmc_applications',arr); auditLog('application',`Application by ${pseudo}`); addPoints(pseudo,5); msgEl.textContent='Candidature envoy√©e'; document.getElementById('fullAppForm').reset(); renderApplications(); });

document.getElementById('helpSend').addEventListener('click', ()=>{ const pseudo=document.getElementById('helpPseudo').value.trim()||'Anon'; const question=document.getElementById('helpQuestion').value.trim(); const msg=document.getElementById('helpMsg'); if(!question){ msg.textContent='Question vide'; return; } const arr=lmc_get('lmc_helpRequests',[]); arr.unshift({pseudo,question,date:new Date().toISOString(),answer:null}); lmc_set('lmc_helpRequests',arr); auditLog('help','Help request by '+pseudo); addPoints(pseudo,2); msg.textContent='Demande d\'aide envoy√©e'; renderHelpRequests(); renderHelpAnswers(); });

// Admin helpers for render
function renderQuickApps(){ const arr=lmc_get('lmc_quick_apps',[]); const el=document.getElementById('quickappsTab'); if(!arr.length){ el.innerHTML='<div class="item">Aucune postulation rapide.</div>'; return; } el.innerHTML = arr.map((q,i)=>`<div class="item"><div><b>${escapeHTML(q.pseudo)}</b><div class="meta">${escapeHTML(q.role)}</div><div class="meta">${new Date(q.date).toLocaleString()}</div></div><div style="display:flex;flex-direction:column;gap:6px"><button onclick="adminHandleQuick(${i})">Traiter</button><button onclick="adminDelQuick(${i})" style="background:var(--danger);color:#fff">Suppr</button></div></div>`).join(''); }
function renderApplications(){ const arr=lmc_get('lmc_applications',[]); const el=document.getElementById('applicationsTab'); if(!arr.length){ el.innerHTML='<div class="item">Aucune candidature.</div>'; return; } el.innerHTML = arr.map((a,i)=>`<div class="item" style="flex-direction:column;align-items:flex-start"><div><b>${escapeHTML(a.pseudo)}</b> ‚Ä¢ ${escapeHTML(a.age||'n/a')} ans ‚Ä¢ ${escapeHTML(a.hours||'n/a')}h</div><div class="meta" style="margin-top:8px">Exp: ${escapeHTML(a.experience||'--')}</div><div class="meta" style="margin-top:8px">Motivation: ${escapeHTML(a.motivation||'--')}</div><div class="meta" style="margin-top:8px">${new Date(a.date).toLocaleString()}</div><div style="margin-top:10px;display:flex;gap:8px"><button onclick="adminAcceptApplication(${i})">Accepter</button><button onclick="adminDeleteApplication(${i})" style="background:var(--danger);color:#fff">Suppr</button></div></div>`).join(''); }

// rendering helpers
function renderAll(){ renderRecentSuggestions(); renderQuickApps(); renderApplications(); renderRoles(); renderHelpRequests(); renderHelpAnswers(); renderMeetingBoard(); renderAudit(); renderLeaderboard(); renderBadges(); }

// Quick admin actions
function adminDeleteSuggestion(i){ const arr=lmc_get('lmc_suggestions',[]); arr.splice(i,1); lmc_set('lmc_suggestions',arr); renderAdminSuggestions(); renderRecentSuggestions(); }
function adminHandleQuick(i){ const arr=lmc_get('lmc_quick_apps',[]); if(!arr[i]) return; arr[i].handled=true; lmc_set('lmc_quick_apps',arr); auditLog('admin',`Quick handled ${arr[i].pseudo}`); renderQuickApps(); }
function adminDelQuick(i){ const arr=lmc_get('lmc_quick_apps',[]); arr.splice(i,1); lmc_set('lmc_quick_apps',arr); auditLog('admin','quick deleted'); renderQuickApps(); }

// ----------------- Initial setup -----------------
window.addEventListener('DOMContentLoaded', ()=>{ renderAll(); renderCultureQuiz(); setupGuess(); setupRPS(); setupDice(); setupMemory(); renderFlag(); scrambleNew(); document.getElementById('btnOpenGames').addEventListener('click', ()=>{ document.querySelector('#games').scrollIntoView({behavior:'smooth'}); }); });

</script>
</body>
</html>
