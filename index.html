<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Les Mecs Chills - Communaut√© & Jeux</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg: #0a0e27;
      --card: #1a1f3a;
      --accent: #4f46e5;
      --accent-hover: #6366f1;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --success: #10b981;
      --danger: #ef4444;
      --warning: #f59e0b;
      --border: rgba(255,255,255,0.1);
      --maxw: 1200px;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      overflow-x: hidden;
    }

    .container {
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Header */
    header {
      background: rgba(26, 31, 58, 0.8);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      padding: 20px 0;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 28px;
      font-weight: 800;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    nav ul {
      display: flex;
      gap: 30px;
      list-style: none;
    }

    nav a {
      color: var(--text);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s;
      cursor: pointer;
    }

    nav a:hover {
      color: var(--accent);
    }

    /* Hero Section */
    .hero {
      padding: 100px 0;
      text-align: center;
      background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
    }

    .hero h1 {
      font-size: 56px;
      font-weight: 900;
      margin-bottom: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .hero p {
      font-size: 20px;
      color: var(--muted);
      margin-bottom: 40px;
    }

    /* Section */
    section {
      padding: 80px 0;
    }

    .section-title {
      font-size: 42px;
      font-weight: 800;
      margin-bottom: 50px;
      text-align: center;
    }

    /* Cards */
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      margin-top: 40px;
    }

    .card {
      background: var(--card);
      border-radius: 16px;
      padding: 30px;
      border: 1px solid var(--border);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 40px rgba(79, 70, 229, 0.3);
    }

    .card h3 {
      font-size: 24px;
      margin-bottom: 15px;
      color: var(--accent);
    }

    /* Game Cards */
    .game-card {
      background: var(--card);
      border-radius: 16px;
      padding: 30px;
      border: 1px solid var(--border);
      margin-bottom: 25px;
    }

    .game-card h3 {
      font-size: 22px;
      margin-bottom: 20px;
      color: var(--accent);
    }

    /* Inputs */
    input, textarea, select {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-size: 15px;
      margin-bottom: 15px;
      transition: border-color 0.3s;
    }

    input:focus, textarea:focus {
      outline: none;
      border-color: var(--accent);
    }

    /* Buttons */
    .btn {
      padding: 12px 28px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: inline-block;
    }

    .btn:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(79, 70, 229, 0.4);
    }

    .btn.small {
      padding: 8px 16px;
      font-size: 14px;
    }

    .btn.ghost {
      background: transparent;
      border: 1px solid var(--border);
    }

    .btn.ghost:hover {
      background: rgba(255,255,255,0.05);
    }

    .btn.success {
      background: var(--success);
    }

    .btn.danger {
      background: var(--danger);
    }

    /* Leaderboard */
    .leaderboard-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      background: rgba(255,255,255,0.03);
      border-radius: 8px;
      margin-bottom: 10px;
      transition: background 0.3s;
    }

    .leaderboard-item:hover {
      background: rgba(255,255,255,0.06);
    }

    .leaderboard-rank {
      font-size: 20px;
      font-weight: 800;
      color: var(--accent);
      min-width: 40px;
    }

    .leaderboard-info {
      flex: 1;
      margin-left: 15px;
    }

    .leaderboard-pseudo {
      font-weight: 600;
      font-size: 16px;
    }

    .leaderboard-points {
      color: var(--muted);
      font-size: 14px;
    }

    /* Messages */
    .message {
      padding: 12px 16px;
      border-radius: 8px;
      margin: 15px 0;
      font-size: 14px;
    }

    .message.success {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
      border: 1px solid rgba(16, 185, 129, 0.3);
    }

    .message.error {
      background: rgba(239, 68, 68, 0.1);
      color: var(--danger);
      border: 1px solid rgba(239, 68, 68, 0.3);
    }

    /* Admin Panel */
    .admin-panel {
      display: none;
      background: var(--card);
      border-radius: 16px;
      padding: 30px;
      border: 1px solid var(--border);
      margin-top: 30px;
    }

    .admin-section {
      margin-bottom: 30px;
      padding-bottom: 30px;
      border-bottom: 1px solid var(--border);
    }

    .admin-section:last-child {
      border-bottom: none;
    }

    .admin-item {
      background: rgba(255,255,255,0.03);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    /* Secret Overlay */
    #secretOverlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(5px);
      z-index: 9999;
      align-items: center;
      justify-content: center;
    }

    .secret-modal {
      background: var(--card);
      padding: 40px;
      border-radius: 20px;
      width: 90%;
      max-width: 600px;
      border: 1px solid var(--border);
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    }

    .small {
      font-size: 14px;
    }

    .muted {
      color: var(--muted);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .hero h1 {
        font-size: 36px;
      }

      .section-title {
        font-size: 32px;
      }

      nav ul {
        flex-direction: column;
        gap: 15px;
      }

      .header-content {
        flex-direction: column;
        gap: 20px;
      }
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in {
      animation: fadeIn 0.6s ease-out;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">üéÆ Les Mecs Chills</div>
        <nav>
          <ul>
            <li><a onclick="scrollToSection('home')">Accueil</a></li>
            <li><a onclick="scrollToSection('games')">Jeux</a></li>
            <li><a onclick="scrollToSection('leaderboard')">Classement</a></li>
            <li><a onclick="scrollToSection('recruitment')">Recrutement</a></li>
            <li><a onclick="scrollToSection('contact')">Contact</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <!-- Hero Section -->
  <section id="home" class="hero">
    <div class="container">
      <h1>Bienvenue chez Les Mecs Chills</h1>
      <p>Rejoins notre communaut√©, joue, progresse et deviens une l√©gende ! üöÄ</p>
      <button class="btn" onclick="scrollToSection('games')">D√©couvrir les jeux</button>
    </div>
  </section>

  <!-- Games Section -->
  <section id="games">
    <div class="container">
      <h2 class="section-title">üéÆ Mini-Jeux</h2>
      
      <!-- Guess Game -->
      <div class="game-card fade-in">
        <h3>üéØ Devine le Nombre</h3>
        <p class="muted">Devine un nombre entre 1 et 50 et gagne 5 points !</p>
        <input id="guess_pseudo" placeholder="Ton pseudo" type="text">
        <input id="guess_number" type="number" placeholder="Entre un nombre (1-50)" min="1" max="50">
        <button class="btn" onclick="playGuessGame()">Jouer</button>
        <div id="guess_result"></div>
      </div>

      <!-- Rock Paper Scissors -->
      <div class="game-card fade-in">
        <h3>‚úä Pierre Feuille Ciseaux</h3>
        <p class="muted">Affronte le bot et gagne 3 points !</p>
        <input id="rps_pseudo" placeholder="Ton pseudo" type="text">
        <div style="display: flex; gap: 10px; margin: 20px 0;">
          <button class="btn" onclick="playRPS('pierre')">‚úä Pierre</button>
          <button class="btn" onclick="playRPS('feuille')">‚úã Feuille</button>
          <button class="btn" onclick="playRPS('ciseaux')">‚úåÔ∏è Ciseaux</button>
        </div>
        <div id="rps_result"></div>
      </div>

      <!-- Dice Game -->
      <div class="game-card fade-in">
        <h3>üé≤ Lancer de D√©s</h3>
        <p class="muted">Lance les d√©s ! Si tu fais 6+6, tu gagnes 10 points !</p>
        <input id="dice_pseudo" placeholder="Ton pseudo" type="text">
        <button class="btn" onclick="playDice()">Lancer les d√©s</button>
        <div id="dice_result"></div>
      </div>
    </div>
  </section>

  <!-- Leaderboard Section -->
  <section id="leaderboard">
    <div class="container">
      <h2 class="section-title">üèÜ Classement Global</h2>
      <div class="game-card">
        <div id="leaderboard_content">
          <p class="muted">Chargement du classement...</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Recruitment Section -->
  <section id="recruitment">
    <div class="container">
      <h2 class="section-title">üìã Recrutement</h2>
      <div class="cards-grid">
        <div class="card">
          <h3>Rejoins l'√©quipe !</h3>
          <p class="muted">Postule pour devenir membre officiel des Mecs Chills</p>
          <input id="recruit_pseudo" placeholder="Ton pseudo Discord">
          <input id="recruit_age" type="number" placeholder="Ton √¢ge">
          <textarea id="recruit_experience" placeholder="Ton exp√©rience en mod√©ration/animation" rows="3"></textarea>
          <input id="recruit_hours" type="number" placeholder="Heures de disponibilit√© par semaine">
          <textarea id="recruit_motivation" placeholder="Pourquoi veux-tu nous rejoindre ?" rows="4"></textarea>
          <button class="btn success" onclick="submitApplication()">Envoyer ma candidature</button>
          <div id="recruit_message"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section id="contact">
    <div class="container">
      <h2 class="section-title">üí¨ Contact</h2>
      <div class="cards-grid">
        <div class="card">
          <h3>Nous contacter</h3>
          <input id="contact_name" placeholder="Ton nom">
          <input id="contact_email" placeholder="Ton email">
          <textarea id="contact_message" placeholder="Ton message" rows="4"></textarea>
          <button class="btn" onclick="submitContact()">Envoyer</button>
          <div id="contact_result"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Admin Panel -->
  <section id="admin_area" class="admin-panel">
    <div class="container">
      <h2 class="section-title">üîê Panneau Admin</h2>
      
      <!-- Admin Login -->
      <div id="admin_login" class="admin-section">
        <h3>Connexion Admin</h3>
        <input id="admin_password" type="password" placeholder="Mot de passe admin">
        <button class="btn" onclick="adminLogin()">Se connecter</button>
        <div id="admin_login_msg"></div>
      </div>

      <!-- Admin Controls -->
      <div id="admin_controls" style="display: none;">
        
        <!-- Points Management -->
        <div class="admin-section">
          <h3>Gestion des Points</h3>
          <input id="points_pseudo" placeholder="Pseudo exact (ex: ChillUser#1234)">
          <input id="points_amount" type="number" placeholder="Nombre de points">
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button class="btn small success" onclick="adminAddPoints()">Ajouter</button>
            <button class="btn small danger" onclick="adminRemovePoints()">Retirer</button>
          </div>
          <div id="points_msg" class="muted small"></div>
        </div>

        <!-- Applications -->
        <div class="admin-section">
          <h3>Candidatures re√ßues</h3>
          <div id="admin_applications"></div>
        </div>

        <!-- Contacts -->
        <div class="admin-section">
          <h3>Messages de contact</h3>
          <div id="admin_contacts"></div>
        </div>

        <!-- Export/Import -->
        <div class="admin-section">
          <h3>Sauvegarde</h3>
          <button class="btn small" onclick="exportData()">Exporter toutes les donn√©es</button>
          <button class="btn small ghost" onclick="clearAllData()">R√©initialiser tout</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Secret Overlay (Ctrl+A) -->
  <div id="secretOverlay">
    <div class="secret-modal">
      <h2>üîê Acc√®s Cr√©ateur</h2>
      <p class="muted">Entrez le code secret pour acc√©der au panneau cr√©ateur</p>
      <input id="secretCodeInput" type="password" placeholder="Code secret">
      <div style="display: flex; gap: 10px; margin-top: 15px;">
        <button class="btn" onclick="validateSecretCode()">Valider</button>
        <button class="btn ghost" onclick="closeSecretOverlay()">Annuler</button>
      </div>
      
      <!-- Secret Controls -->
      <div id="secretControls" style="display: none; margin-top: 30px;">
        <h3>Contr√¥les Cr√©ateur</h3>
        
        <!-- Quick Points -->
        <div style="margin: 20px 0;">
          <h4>Gestion rapide des points</h4>
          <input id="secret_pseudo" placeholder="Pseudo exact">
          <input id="secret_amount" type="number" placeholder="Montant">
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button class="btn small success" onclick="secretAddPoints()">+ Ajouter</button>
            <button class="btn small danger" onclick="secretRemovePoints()">- Retirer</button>
          </div>
          <div id="secret_msg" class="muted small"></div>
        </div>

        <!-- Python Terminal -->
        <div style="margin: 20px 0;">
          <h4>üêç Terminal Python</h4>
          <textarea id="python_code" placeholder="Entrez du code Python ici..." rows="5"></textarea>
          <button class="btn small" onclick="runPythonCode()">Ex√©cuter</button>
          <div id="python_output" style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; margin-top: 10px; font-family: monospace; white-space: pre-wrap;"></div>
        </div>

        <!-- Music Control -->
        <div style="margin: 20px 0;">
          <h4>üéµ Musique</h4>
          <button class="btn small" onclick="playMusic()">‚ñ∂Ô∏è Lecture</button>
          <button class="btn small ghost" onclick="stopMusic()">‚è∏ Pause</button>
        </div>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
  <script>
    // ===== HELPERS =====
    function lget(k, def) {
      try {
        const r = localStorage.getItem(k);
        return r ? JSON.parse(r) : def;
      } catch(e) {
        console.error('lget error:', e);
        return def;
      }
    }

    function lset(k, v) {
      try {
        localStorage.setItem(k, JSON.stringify(v));
        return true;
      } catch(e) {
        console.error('lset error:', e);
        return false;
      }
    }

    function now() {
      return new Date().toISOString().replace('T', ' ').slice(0, 16);
    }

    function esc(s) {
      if (s == null) return '';
      return String(s).replace(/[&<>"']/g, ch => ({
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#39;'
      }[ch]));
    }

    function auditLog(type, message) {
      const logs = lget('lmc_audit', []);
      logs.unshift({ time: new Date().toISOString(), type, message });
      lset('lmc_audit', logs.slice(0, 500));
    }

    // ===== POINTS SYSTEM =====
    function getPointsMap() {
      return lget('lmc_points', {});
    }

    function setPointsMap(m) {
      lset('lmc_points', m);
    }

    function addPointsToPseudo(pseudo, amount) {
      if (!pseudo) return false;
      const map = getPointsMap();
      const cur = parseInt(map[pseudo] || 0, 10) || 0;
      map[pseudo] = cur + Number(amount);
      setPointsMap(map);
      auditLog('points', `+${amount} to ${pseudo}`);
      return true;
    }

    function removePointsFromPseudo(pseudo, amount) {
      if (!pseudo) return false;
      const map = getPointsMap();
      const cur = parseInt(map[pseudo] || 0, 10) || 0;
      map[pseudo] = Math.max(0, cur - Number(amount));
      setPointsMap(map);
      auditLog('points', `-${amount} from ${pseudo}`);
      return true;
    }

    function getPointsForPseudo(pseudo) {
      const map = getPointsMap();
      return parseInt(map[pseudo] || 0, 10) || 0;
    }

    function getLeaderboard(limit = 100) {
      const map = getPointsMap();
      return Object.keys(map)
        .map(p => ({ pseudo: p, points: map[p] }))
        .sort((a, b) => b.points - a.points)
        .slice(0, limit);
    }

    // ===== RENDER LEADERBOARD =====
    function renderLeaderboard() {
      const el = document.getElementById('leaderboard_content');
      if (!el) return;
      
      const list = getLeaderboard(100);
      if (list.length === 0) {
        el.innerHTML = '<p class="muted">Aucun score enregistr√© pour le moment. Sois le premier √† jouer !</p>';
        return;
      }

      let html = '';
      list.forEach((r, i) => {
        html += `
          <div class="leaderboard-item">
            <div class="leaderboard-rank">#${i + 1}</div>
            <div class="leaderboard-info">
              <div class="leaderboard-pseudo">${esc(r.pseudo)}</div>
              <div class="leaderboard-points">${r.points} points</div>
            </div>
          </div>
        `;
      });
      el.innerHTML = html;
    }

    // ===== GAMES =====
    function playGuessGame() {
      const pseudo = document.getElementById('guess_pseudo').value.trim();
      const guess = parseInt(document.getElementById('guess_number').value);
      const result = document.getElementById('guess_result');

      if (!pseudo) {
        result.innerHTML = '<div class="message error">Entre ton pseudo !</div>';
        return;
      }

      if (isNaN(guess) || guess < 1 || guess > 50) {
        result.innerHTML = '<div class="message error">Entre un nombre entre 1 et 50 !</div>';
        return;
      }

      const target = Math.floor(Math.random() * 50) + 1;
      
      if (guess === target) {
        addPointsToPseudo(pseudo, 5);
        result.innerHTML = `<div class="message success">üéâ Bravo ${esc(pseudo)} ! Le nombre √©tait ${target}. Tu gagnes 5 points !</div>`;
        renderLeaderboard();
      } else {
        result.innerHTML = `<div class="message error">Rat√© ! Le nombre √©tait ${target}. ${guess < target ? 'C\'√©tait plus !' : 'C\'√©tait moins !'}</div>`;
      }
    }

    function playRPS(choice) {
      const pseudo = document.getElementById('rps_pseudo').value.trim();
      const result = document.getElementById('rps_result');

      if (!pseudo) {
        result.innerHTML = '<div class="message error">Entre ton pseudo !</div>';
        return;
      }

      const choices = ['pierre', 'feuille', 'ciseaux'];
      const botChoice = choices[Math.floor(Math.random() * 3)];
      
      const icons = { pierre: '‚úä', feuille: '‚úã', ciseaux: '‚úåÔ∏è' };
      
      if (choice === botChoice) {
        result.innerHTML = `<div class="message">√âgalit√© ! Vous avez tous les deux choisi ${icons[choice]} ${choice}</div>`;
      } else if (
        (choice === 'pierre' && botChoice === 'ciseaux') ||
        (choice === 'feuille' && botChoice === 'pierre') ||
        (choice === 'ciseaux' && botChoice === 'feuille')
      ) {
        addPointsToPseudo(pseudo, 3);
        result.innerHTML = `<div class="message success">üéâ Victoire ! Tu as choisi ${icons[choice]} ${choice}, le bot a choisi ${icons[botChoice]} ${botChoice}. +3 points !</div>`;
        renderLeaderboard();
      } else {
        result.innerHTML = `<div class="message error">D√©faite ! Tu as choisi ${icons[choice]} ${choice}, le bot a choisi ${icons[botChoice]} ${botChoice}.</div>`;
      }
    }

    function playDice() {
      const pseudo = document.getElementById('dice_pseudo').value.trim();
      const result = document.getElementById('dice_result');

      if (!pseudo) {
        result.innerHTML = '<div class="message error">Entre ton pseudo !</div>';
        return;
      }

      const dice1 = Math.floor(Math.random() * 6) + 1;
      const dice2 = Math.floor(Math.random() * 6) + 1;
      const total = dice1 + dice2;

      if (dice1 === 6 && dice2 === 6) {
        addPointsToPseudo(pseudo, 10);
        result.innerHTML = `<div class="message success">üé≤üé≤ JACKPOT ! Tu as fait ${dice1} + ${dice2} = ${total} ! +10 points !</div>`;
        renderLeaderboard();
      } else if (total >= 10) {
        addPointsToPseudo(pseudo, 3);
        result.innerHTML = `<div class="message success">üé≤ Super ! Tu as fait ${dice1} + ${dice2} = ${total}. +3 points !</div>`;
        renderLeaderboard();
      } else {
        result.innerHTML = `<div class="message">üé≤ Tu as fait ${dice1} + ${dice2} = ${total}. Retente ta chance !</div>`;
      }
    }

    // ===== RECRUITMENT =====
    function submitApplication() {
      const pseudo = document.getElementById('recruit_pseudo').value.trim();
      const age = document.getElementById('recruit_age').value.trim();
      const experience = document.getElementById('recruit_experience').value.trim();
      const hours = document.getElementById('recruit_hours').value.trim();
      const motivation = document.getElementById('recruit_motivation').value.trim();
      const msg = document.getElementById('recruit_message');

      if (!pseudo || !age || !experience || !hours || !motivation) {
        msg.innerHTML = '<div class="message error">Remplis tous les champs !</div>';
        return;
      }

      const apps = lget('lmc_applications', []);
      apps.unshift({
        id: Date.now().toString(36),
        pseudo,
        age: Number(age),
        experience,
        hours: Number(hours),
        motivation,
        date: now()
      });
      lset('lmc_applications', apps);
      auditLog('application', `New application: ${pseudo}`);

      msg.innerHTML = '<div class="message success">‚úÖ Candidature envoy√©e avec succ√®s ! Nous reviendrons vers toi bient√¥t.</div>';
      
      // Clear form
      document.getElementById('recruit_pseudo').value = '';
      document.getElementById('recruit_age').value = '';
      document.getElementById('recruit_experience').value = '';
      document.getElementById('recruit_hours').value = '';
      document.getElementById('recruit_motivation').value = '';
      
      renderAdminData();
    }

    // ===== CONTACT =====
    function submitContact() {
      const name = document.getElementById('contact_name').value.trim();
      const email = document.getElementById('contact_email').value.trim();
      const message = document.getElementById('contact_message').value.trim();
      const result = document.getElementById('contact_result');

      if (!name || !email || !message) {
        result.innerHTML = '<div class="message error">Remplis tous les champs !</div>';
        return;
      }

      const contacts = lget('lmc_contacts', []);
      contacts.unshift({
        name,
        email,
        msg: message,
        date: now()
      });
      lset('lmc_contacts', contacts);
      auditLog('contact', `New contact: ${name}`);

      result.innerHTML = '<div class="message success">‚úÖ Message envoy√© ! Nous te r√©pondrons bient√¥t.</div>';
      
      document.getElementById('contact_name').value = '';
      document.getElementById('contact_email').value = '';
      document.getElementById('contact_message').value = '';
      
      renderAdminData();
    }

    // ===== ADMIN PANEL =====
    function adminLogin() {
      const password = document.getElementById('admin_password').value;
      const msg = document.getElementById('admin_login_msg');

      if (password === '89mLh21') {
        document.getElementById('admin_controls').style.display = 'block';
        document.getElementById('admin_login').style.display = 'none';
        msg.innerHTML = '<div class="message success">‚úÖ Connect√© en tant qu\'admin</div>';
        renderAdminData();
      } else {
        msg.innerHTML = '<div class="message error">‚ùå Mot de passe incorrect</div>';
      }
    }

    function adminAddPoints() {
      const pseudo = document.getElementById('points_pseudo').value.trim();
      const amount = Number(document.getElementById('points_amount').value) || 0;
      const msg = document.getElementById('points_msg');

      if (!pseudo || !amount) {
        msg.textContent = 'Pseudo + montant requis';
        return;
      }

      addPointsToPseudo(pseudo, amount);
      msg.textContent = `‚úÖ +${amount} points ajout√©s √† ${pseudo}`;
      renderLeaderboard();
    }

    function adminRemovePoints() {
      const pseudo = document.getElementById('points_pseudo').value.trim();
      const amount = Number(document.getElementById('points_amount').value) || 0;
      const msg = document.getElementById('points_msg');

      if (!pseudo || !amount) {
        msg.textContent = 'Pseudo + montant requis';
        return;
      }

      removePointsFromPseudo(pseudo, amount);
      msg.textContent = `‚úÖ ${amount} points retir√©s √† ${pseudo}`;
      renderLeaderboard();
    }

    function renderAdminData() {
      // Applications
      const appsEl = document.getElementById('admin_applications');
      if (appsEl) {
        const apps = lget('lmc_applications', []);
        if (apps.length === 0) {
          appsEl.innerHTML = '<p class="muted">Aucune candidature pour le moment</p>';
        } else {
          let html = '';
          apps.forEach(app => {
            html += `
              <div class="admin-item">
                <strong>${esc(app.pseudo)}</strong> - ${app.age} ans
                <div class="small muted">Postul√© le ${app.date}</div>
                <div style="margin-top: 10px;">
                  <strong>Exp√©rience:</strong> ${esc(app.experience)}<br>
                  <strong>Disponibilit√©:</strong> ${app.hours}h/semaine<br>
                  <strong>Motivation:</strong> ${esc(app.motivation)}
                </div>
                <button class="btn small danger" style="margin-top: 10px;" onclick="deleteApplication('${app.id}')">üóë Supprimer</button>
              </div>
            `;
          });
          appsEl.innerHTML = html;
        }
      }

      // Contacts
      const contactsEl = document.getElementById('admin_contacts');
      if (contactsEl) {
        const contacts = lget('lmc_contacts', []);
        if (contacts.length === 0) {
          contactsEl.innerHTML = '<p class="muted">Aucun message de contact</p>';
        } else {
          let html = '';
          contacts.forEach((contact, idx) => {
            html += `
              <div class="admin-item">
                <strong>${esc(contact.name)}</strong> - ${esc(contact.email)}
                <div class="small muted">${contact.date}</div>
                <div style="margin-top: 10px;">${esc(contact.msg)}</div>
                <button class="btn small danger" style="margin-top: 10px;" onclick="deleteContact(${idx})">üóë Supprimer</button>
              </div>
            `;
          });
          contactsEl.innerHTML = html;
        }
      }
    }

    function deleteApplication(id) {
      const apps = lget('lmc_applications', []);
      const filtered = apps.filter(app => app.id !== id);
      lset('lmc_applications', filtered);
      renderAdminData();
    }

    function deleteContact(idx) {
      const contacts = lget('lmc_contacts', []);
      contacts.splice(idx, 1);
      lset('lmc_contacts', contacts);
      renderAdminData();
    }

    function exportData() {
      const data = {
        points: lget('lmc_points', {}),
        applications: lget('lmc_applications', []),
        contacts: lget('lmc_contacts', []),
        audit: lget('lmc_audit', [])
      };
      
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `lmc_backup_${Date.now()}.json`;
      a.click();
      URL.revokeObjectURL(url);
    }

    function clearAllData() {
      if (confirm('‚ö†Ô∏è ATTENTION ! Cela va supprimer TOUTES les donn√©es. Es-tu s√ªr ?')) {
        localStorage.clear();
        alert('‚úÖ Toutes les donn√©es ont √©t√© supprim√©es');
        location.reload();
      }
    }

    // ===== SECRET OVERLAY (Ctrl+A) =====
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey && (e.key === 'a' || e.key === 'A')) {
        e.preventDefault();
        const overlay = document.getElementById('secretOverlay');
        if (overlay) overlay.style.display = 'flex';
        document.getElementById('secretCodeInput').value = '';
        document.getElementById('secretControls').style.display = 'none';
      }
    });

    function closeSecretOverlay() {
      document.getElementById('secretOverlay').style.display = 'none';
    }

    function validateSecretCode() {
      const code = document.getElementById('secretCodeInput').value.trim();
      if (code === '56710') {
        document.getElementById('secretControls').style.display = 'block';
        document.getElementById('secret_msg').textContent = '‚úÖ Acc√®s valid√© - Bienvenue cr√©ateur';
      } else {
        document.getElementById('secret_msg').textContent = '‚ùå Code incorrect';
      }
    }

    function secretAddPoints() {
      const pseudo = document.getElementById('secret_pseudo').value.trim();
      const amount = Number(document.getElementById('secret_amount').value) || 0;
      const msg = document.getElementById('secret_msg');

      if (!pseudo || !amount) {
        msg.textContent = '‚ùå Pseudo + montant requis';
        return;
      }

      addPointsToPseudo(pseudo, amount);
      msg.textContent = `‚úÖ +${amount} points ajout√©s √† ${pseudo}`;
      renderLeaderboard();
    }

    function secretRemovePoints() {
      const pseudo = document.getElementById('secret_pseudo').value.trim();
      const amount = Number(document.getElementById('secret_amount').value) || 0;
      const msg = document.getElementById('secret_msg');

      if (!pseudo || !amount) {
        msg.textContent = '‚ùå Pseudo + montant requis';
        return;
      }

      removePointsFromPseudo(pseudo, amount);
      msg.textContent = `‚úÖ ${amount} points retir√©s √† ${pseudo}`;
      renderLeaderboard();
    }

    // ===== PYTHON INTEGRATION =====
    let pyodide = null;

    async function initPyodide() {
      if (pyodide) return pyodide;
      
      const output = document.getElementById('python_output');
      if (output) output.textContent = '‚è≥ Chargement de Python...';
      
      try {
        pyodide = await loadPyodide({
          indexURL: "https://cdn.jsdelivr.net/pyodide/v0.23.4/full/"
        });
        
        if (output) output.textContent = '‚úÖ Python pr√™t ! Vous pouvez maintenant ex√©cuter du code.';
        return pyodide;
      } catch (e) {
        if (output) output.textContent = '‚ùå Erreur lors du chargement de Python: ' + e.message;
        return null;
      }
    }

    async function runPythonCode() {
      const code = document.getElementById('python_code').value;
      const output = document.getElementById('python_output');
      
      if (!code.trim()) {
        output.textContent = '‚ùå Entre du code Python √† ex√©cuter';
        return;
      }

      try {
        if (!pyodide) {
          await initPyodide();
        }
        
        output.textContent = '‚è≥ Ex√©cution...';
        
        // Redirect stdout
        pyodide.runPython(`
import sys
from io import StringIO
sys.stdout = StringIO()
        `);
        
        const result = pyodide.runPython(code);
        const stdout = pyodide.runPython('sys.stdout.getvalue()');
        
        let displayResult = '';
        if (stdout) displayResult += stdout;
        if (result !== undefined && result !== null) {
          displayResult += (displayResult ? '\n' : '') + '>>> ' + result;
        }
        
        output.textContent = displayResult || '‚úÖ Code ex√©cut√© (aucune sortie)';
      } catch (e) {
        output.textContent = '‚ùå Erreur Python:\n' + e.message;
      }
    }

    // ===== MUSIC CONTROL =====
    let secretAudio = null;

    function ensureSecretAudio() {
      if (!secretAudio) {
        // Note: You'll need to provide your own music file
        secretAudio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBjGJ0O+7bSYEH3DH8+CXRQsQWKvi7rFgGgc2kNXuxXElBSp+zPHaizsIFWS46+OZTgwLTKXh8bllHAU2jdXvxG8oBS1/yvDajjsIE2G26+GgUhQLSaDe8bVjHQU5kdPuxXImBSl4yO/ckDwJElqy5O2qXBkHNIvU7sNyJQUpeMrw3ZI+CRJYr+Xur1sZBzaP1O7FcSUFKnjK8N2SOwoSWK/l7q9bGQc2j9TuxXElBSp4yvDdkjsKEliv5e6vWxkHNo/U7sVxJQUqeMrw3ZI7ChJYr+Xur1sZBzaP1O7FcSUFKnjK8N2SOwoSWK/l7q9bGQc2j9TuxXElBSp4yvDdkjsKEliv5e6vWxkHNo/U7sVxJQUqeMrw3ZI7ChJYr+Xur1sZBzaP1O7FcSUFKnjK8N2SOwoSWK/l7q9bGQc2j9TuxXElBSp4yvDdkjsKEliv5e6vWxkHNo/U7sVxJQUqeMrw3ZI7ChJYr+Xur1sZBzaP1O7FcSUFKnjK8N2SOwoSWK/l7q9bGQc2j9TuxXElBSp4yvDdkjsK');
        secretAudio.loop = true;
      }
    }

    function playMusic() {
      ensureSecretAudio();
      secretAudio.play().catch(() => {
        document.getElementById('secret_msg').textContent = '‚ùå Le navigateur bloque la lecture automatique. Clique √† nouveau.';
      });
    }

    function stopMusic() {
      if (secretAudio) {
        secretAudio.pause();
        secretAudio.currentTime = 0;
      }
    }

    // ===== SCROLL TO SECTION =====
    function scrollToSection(id) {
      const element = document.getElementById(id);
      if (element) {
        element.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    // ===== SHOW ADMIN PANEL =====
    function showAdminPanel() {
      document.getElementById('admin_area').style.display = 'block';
      scrollToSection('admin_area');
    }

    // ===== INITIALIZATION =====
    document.addEventListener('DOMContentLoaded', function() {
      // Render leaderboard on load
      renderLeaderboard();
      
      // Show admin panel (always visible)
      showAdminPanel();
      
      // Add smooth scroll behavior
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
        });
      });

      console.log('üéÆ Les Mecs Chills - Site charg√© avec succ√®s !');
      console.log('üí° Appuie sur Ctrl+A pour acc√©der au panneau cr√©ateur');
    });
  </script>

</body>
</html>
